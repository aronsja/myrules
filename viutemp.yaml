mixed-port: 7890
allow-lan: true
bind-address: "*"
# Only applicable when setting allow-lan to true
# "*": bind all IP addresses
# 192.168.122.11: bind a single IPv4 address
# "[aaaa::a8aa:ff:fe09:57d8]": bind a single IPv6 address
mode: Rule
log-level: info
external-controller: :9090

dns:
  enable: true # å…³é—­å°†ä½¿ç”¨ç³»ç»Ÿ DNS
  prefer-h3: true # å¼€å¯ DoH æ”¯æŒ HTTP/3ï¼Œå°†å¹¶å‘å°è¯•
  listen: 0.0.0.0:53 # å¼€å¯ DNS æœåŠ¡å™¨ç›‘å¬
  # ipv6: false # false å°†è¿”å› AAAA çš„ç©ºç»“æœ
  # ipv6-timeout: 300 # å•ä½ï¼šmsï¼Œå†…éƒ¨åŒæ ˆå¹¶å‘æ—¶ï¼Œå‘ä¸Šæ¸¸æŸ¥è¯¢ AAAA æ—¶ï¼Œç­‰å¾… AAAA çš„æ—¶é—´ï¼Œé»˜è®¤ 100ms
  # ç”¨äºè§£æ nameserverï¼Œfallback ä»¥åŠå…¶ä»–DNSæœåŠ¡å™¨é…ç½®çš„ï¼ŒDNS æœåŠ¡åŸŸå
  # åªèƒ½ä½¿ç”¨çº¯ IP åœ°å€ï¼Œå¯ä½¿ç”¨åŠ å¯† DNS
  default-nameserver:
    - 114.114.114.114
    - 8.8.8.8
    - tls://1.12.12.12:853
    - tls://223.5.5.5:853
    - system # append DNS server from system configuration. If not found, it would print an error log and skip.
  enhanced-mode: fake-ip # or redir-host

  fake-ip-range: 198.18.0.1/16 # fake-ip æ± è®¾ç½®

  # use-hosts: true # æŸ¥è¯¢ hosts

  # é…ç½®ä¸ä½¿ç”¨fake-ipçš„åŸŸå
  # fake-ip-filter:
  #   - '*.lan'
  #   - localhost.ptlogin2.qq.com

  # DNSä¸»è¦åŸŸåé…ç½®
  # æ”¯æŒ UDPï¼ŒTCPï¼ŒDoTï¼ŒDoHï¼ŒDoQ
  # è¿™éƒ¨åˆ†ä¸ºä¸»è¦ DNS é…ç½®ï¼Œå½±å“æ‰€æœ‰ç›´è¿ï¼Œç¡®ä¿ä½¿ç”¨å¯¹å¤§é™†è§£æç²¾å‡†çš„ DNS
  nameserver:
    #- 114.114.114.114 # default value
    #- 8.8.8.8 # default value
    - tls://223.5.5.5:853 # DNS over TLS
    - https://doh.pub/dns-query # DNS over HTTPS
    - https://dns.alidns.com/dns-query#h3=true # å¼ºåˆ¶ HTTP/3ï¼Œä¸ perfer-h3 æ— å…³ï¼Œå¼ºåˆ¶å¼€å¯ DoH çš„ HTTP/3 æ”¯æŒï¼Œè‹¥ä¸æ”¯æŒå°†æ— æ³•ä½¿ç”¨
    #- https://mozilla.cloudflare-dns.com/dns-query#DNS&h3=true # æŒ‡å®šç­–ç•¥ç»„å’Œä½¿ç”¨ HTTP/3
    - dhcp://en0 # dns from dhcp
    - quic://dns.adguard.com:784 # DNS over QUIC
    # - '8.8.8.8#en0' # å…¼å®¹æŒ‡å®šDNSå‡ºå£ç½‘å¡

  # å½“é…ç½® fallback æ—¶ï¼Œä¼šæŸ¥è¯¢ nameserver ä¸­è¿”å›çš„ IP æ˜¯å¦ä¸º CNï¼Œéå¿…è¦é…ç½®
  # å½“ä¸æ˜¯ CNï¼Œåˆ™ä½¿ç”¨ fallback ä¸­çš„ DNS æŸ¥è¯¢ç»“æœ
  # ç¡®ä¿é…ç½® fallback æ—¶èƒ½å¤Ÿæ­£å¸¸æŸ¥è¯¢
   fallback:
  #   - tcp://1.1.1.1
     - 'tcp://1.1.1.1#â™»ï¸ è‡ªåŠ¨é€‰æ‹©' # æŒ‡å®š DNS è¿‡ä»£ç†æŸ¥è¯¢ï¼ŒProxyGroupName ä¸ºç­–ç•¥ç»„åæˆ–èŠ‚ç‚¹åï¼Œè¿‡ä»£ç†é…ç½®ä¼˜å…ˆäºé…ç½®å‡ºå£ç½‘å¡ï¼Œå½“æ‰¾ä¸åˆ°ç­–ç•¥ç»„æˆ–èŠ‚ç‚¹ååˆ™è®¾ç½®ä¸ºå‡ºå£ç½‘å¡

  # ä¸“ç”¨äºèŠ‚ç‚¹åŸŸåè§£æçš„ DNS æœåŠ¡å™¨ï¼Œéå¿…è¦é…ç½®é¡¹
  # é…ç½®æœåŠ¡å™¨è‹¥æŸ¥è¯¢å¤±è´¥å°†ä½¿ç”¨ nameserverï¼Œéå¹¶å‘æŸ¥è¯¢
   proxy-server-nameserver:
   - https://dns.google/dns-query
   - tls://one.one.one.one

  # é…ç½® fallback ä½¿ç”¨æ¡ä»¶
   fallback-filter:
     geoip: true # é…ç½®æ˜¯å¦ä½¿ç”¨ geoip
     geoip-code: CN # å½“ nameserver åŸŸåçš„ IP æŸ¥è¯¢ geoip åº“ä¸º CN æ—¶ï¼Œä¸ä½¿ç”¨ fallback ä¸­çš„ DNS æŸ¥è¯¢ç»“æœ
  #   é…ç½®å¼ºåˆ¶ fallbackï¼Œä¼˜å…ˆäº IP åˆ¤æ–­ï¼Œå…·ä½“åˆ†ç±»è‡ªè¡ŒæŸ¥çœ‹ geosite åº“
     geosite:
       - gfw
  #   å¦‚æœä¸åŒ¹é… ipcidr åˆ™ä½¿ç”¨ nameservers ä¸­çš„ç»“æœ
     ipcidr:
       - 240.0.0.0/4
     domain:
       - '+.google.com'
       - '+.facebook.com'
       - '+.youtube.com'

  # é…ç½®æŸ¥è¯¢åŸŸåä½¿ç”¨çš„ DNS æœåŠ¡å™¨
  nameserver-policy:
    #   'www.baidu.com': '114.114.114.114'
    #   '+.internal.crop.com': '10.0.0.1'
    "geosite:cn,private,apple":
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
    "geosite:category-ads-all": rcode://success
    "www.baidu.com,+.google.cn": [223.5.5.5, https://dns.alidns.com/dns-query]
    ## globalï¼Œdns ä¸º rule-providers ä¸­çš„åä¸º global å’Œ dns è§„åˆ™è®¢é˜…ï¼Œ
    ## ä¸” behavior å¿…é¡»ä¸º domain/classicalï¼Œå½“ä¸º classical æ—¶ä»…ä¼šç”Ÿæ•ˆåŸŸåç±»è§„åˆ™
    # "rule-set:global,dns": 8.8.8.8


proxy-providers:
  âœˆï¸ VIUIM:
    type: http
    url: ""
    interval: 86400 #æ›´æ–°é—´éš”ï¼Œå•ä½S
    path: ./VIUIM.yaml
    health-check:
      enable: true
      interval: 300 #å¥åº·æ£€æŸ¥é—´éš”ï¼Œå•ä½S
      #lazy: true
      url: https://cp.cloudflare.com/generate_204
  âœˆï¸ æœºåœº:
    type: http
    url: ""
    interval: 86400
    path: ./æœºåœº.yaml
    health-check:
      enable: true
      interval: 300
      #lazy: true
      url: https://cp.cloudflare.com/generate_204

proxy-groups:
  - name: âœˆï¸ VIUIM
    type: url-test # ä»£ç†ç»„ç±»å‹ï¼Œå°†æŒ‰ç…§ url æµ‹è¯•ç»“æœä½¿ç”¨å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹
    filter: 'æ¸¯|å°|æ—¥|éŸ©|æ–°åŠ å¡|ç¾' # æœºåœºèŠ‚ç‚¹ç­›é€‰å…³é”®è¯
    url: "https://cp.cloudflare.com/generate_204"
    interval: 60
    tolerance: 50
    #strategy: consistent-hashing # or round-robin
    proxies:
    use:
      - âœˆï¸ VIUIM
  - name: âœˆï¸ æœºåœº
    type: load-balance # load-balance å°†æŒ‰ç…§ç®—æ³•éšæœºé€‰æ‹©èŠ‚ç‚¹
    filter: 'æ¸¯|å°|æ—¥|éŸ©|æ–°åŠ å¡|ç¾' # æœºåœºèŠ‚ç‚¹ç­›é€‰å…³é”®è¯
    url: "https://cp.cloudflare.com/generate_204"
    interval: 60
    #tolerance: 50
    strategy: round-robin
    proxies:
    use:
      - âœˆï¸ æœºåœº


  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - DIRECT
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: https://cp.cloudflare.com/generate_204
    interval: 600
    proxies:
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ¤– OpenAi
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸŒ æ²¹ç®¡
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ¯ å…¨çƒç›´è¿
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ¥ Netflix
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - ğŸ¯ å…¨çƒç›´è¿
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ“² ç”µæŠ¥ä¿¡æ¯
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ¯ å…¨çƒç›´è¿
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: â“‚ï¸ å¾®è½¯æœåŠ¡
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ è‹¹æœæœåŠ¡
    type: select
    proxies:
      - ğŸ¯ å…¨çƒç›´è¿
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ“¢ HBO
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ¯ å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº
  - name: ğŸ›‘ å…¨çƒæ‹¦æˆª
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: ğŸƒ åº”ç”¨å‡€åŒ–
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ¯ å…¨çƒç›´è¿
      - âœˆï¸ VIUIM
      - âœˆï¸ æœºåœº


rule-providers:
  myproxy:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/aronsja/myrules/main/proxy.yaml"
    interval: 86400
    path: ./ruleset/myproxy.yaml
  mydirect:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/aronsja/myrules/main/direct.yaml"
    interval: 86400
    path: ./ruleset/mydirect.yaml
  myreject:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/aronsja/myrules/main/reject.yaml"
    interval: 86400
    path: ./ruleset/myreject.yaml    
  LocalAreaNetwork:
    behavior: classical # domain, ipcidr or classical (premium core only)
    type: http
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/LocalAreaNetwork.yaml"
    interval: 86400
    path: ./ruleset/LocalAreaNetwork.yaml
  UnBan:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/UnBan.yaml"
    interval: 86400
    path: ./ruleset/UnBan.yaml
  BanAD:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingLite/AdvertisingLite.yaml"
    interval: 86400
    path: ./ruleset/BanAD.yaml
  BanProgramAD:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/BanProgramAD.yaml"
    interval: 86400
    path: ./ruleset/BanProgramAD.yaml
  HBO:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/HBO/HBO.yaml"
    interval: 86400
    path: ./ruleset/HBO.yaml
  HBOAsia:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/HBOAsia/HBOAsia.yaml"
    interval: 86400
    path: ./ruleset/HBOAsia.yaml
  SteamCN:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/SteamCN.yaml"
    interval: 86400
    path: ./ruleset/SteamCN.yaml
  Microsoft:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml"
    interval: 86400
    path: ./ruleset/Microsoft.yaml
  Apple:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml"
    interval: 86400
    path: ./ruleset/Apple.yaml
  YouTube:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml"
    interval: 86400
    path: ./ruleset/YouTube.yaml
  Telegram:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml"
    interval: 86400
    path: ./ruleset/Telegram.yaml
  ProxyLite:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Proxy/Proxy_Classical.yaml"
    interval: 86400
    path: ./ruleset/Proxy.yaml
  Netflix:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml"
    interval: 86400
    path: ./ruleset/Netflix.yaml
  China:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax.yaml"
    interval: 86400
    path: ./ruleset/ChinaMax.yaml
  OpenAi:
    behavior: classical
    type: http
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml"
    interval: 86400
    path: ./ruleset/OpenAi.yaml

rules:
 - RULE-SET,OpenAi,ğŸ¤– OpenAi
 - RULE-SET,LocalAreaNetwork,ğŸ¯ å…¨çƒç›´è¿
 - RULE-SET,UnBan,ğŸ¯ å…¨çƒç›´è¿
 - RULE-SET,BanAD,ğŸ›‘ å…¨çƒæ‹¦æˆª
 - RULE-SET,BanProgramAD,ğŸƒ åº”ç”¨å‡€åŒ–
 - RULE-SET,HBO,ğŸ“¢ HBO
 - RULE-SET,HBOAsia,ğŸ“¢ HBO
 - RULE-SET,GoogleCN,ğŸ¯ å…¨çƒç›´è¿
 - RULE-SET,SteamCN,ğŸ¯ å…¨çƒç›´è¿
 - RULE-SET,Microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
 - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
 - RULE-SET,Telegram,ğŸ“² ç”µæŠ¥ä¿¡æ¯
 - RULE-SET,ProxyLite,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
 - RULE-SET,YouTube,ğŸŒ æ²¹ç®¡
 - RULE-SET,Netflix,ğŸ¥ Netflix
 - RULE-SET,China,ğŸ¯ å…¨çƒç›´è¿
 - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿
 - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
